AGENT: architecture
FINDINGS:
- FINDING: agntc.json write-or-skip-or-overwrite logic duplicated between scaffoldSkill and scaffoldPlugin
  SEVERITY: medium
  FILES: src/init/scaffold-skill.ts:18-31, src/init/scaffold-plugin.ts:17-30
  DESCRIPTION: Both scaffoldSkill and scaffoldPlugin contain a near-identical 14-line block that builds the agntc.json content, checks existence, branches on reconfigure to decide overwrite/skip/create, and pushes to the appropriate result array. This was flagged in cycle 1's duplication report as the largest single block of duplicated logic. The cycle 1 report expected the scaffoldCollection composition (Task 2) to resolve this, but it only eliminated the third copy -- two identical copies remain. The block is not trivially different between the two functions: both build the same JSON, both use the same branching logic, both push to the same named arrays. If the agntc.json schema changes (e.g., adding a version field), both must be updated in lockstep. This is the only remaining significant duplication in the scaffold layer.
  RECOMMENDATION: Extract a helper such as `writeOrSkipConfig(targetDir: string, agents: AgentId[], reconfigure?: boolean): Promise<{path: string; status: "created" | "skipped" | "overwritten"}>` into scaffold-utils.ts. Both scaffoldSkill and scaffoldPlugin call it and push to the appropriate result array based on the returned status. This eliminates the duplicated branching logic and makes the agntc.json schema a single-point-of-change.

- FINDING: pre-check duplicates pathExists logic instead of importing the shared utility
  SEVERITY: low
  FILES: src/init/pre-check.ts:13-17, src/init/scaffold-utils.ts:9-16
  DESCRIPTION: pre-check.ts uses a raw `access(configPath)` wrapped in try/catch (lines 13-17) to test for file existence -- the exact same pattern that scaffold-utils.ts exports as `pathExists`. The shared utility was introduced in Phase 4 specifically for this purpose, but pre-check was not updated to use it. This is a missed composition opportunity rather than a correctness issue: the two implementations will produce identical results. However, having two filesystem-existence patterns in the same feature module undermines the purpose of extracting the shared utility.
  RECOMMENDATION: Import `pathExists` from `./scaffold-utils.js` in pre-check.ts and replace the inline try/catch block with `if (!(await pathExists(configPath))) return { status: "fresh" }`. Alternatively, if pre-check should not depend on scaffold-utils (to keep the pre-check module independent of scaffolding), move pathExists to a more general shared location like `src/init/fs-utils.ts` and have both modules import from there.

SUMMARY: The Phase 4 refinements successfully addressed the major cycle 1 issues -- scaffoldCollection now composes with scaffoldPlugin, signatures are unified, types are shared and tight. Two residual concerns remain: the agntc.json write-or-skip-or-overwrite logic is still duplicated between scaffoldSkill and scaffoldPlugin (medium), and pre-check duplicates the pathExists pattern rather than importing the shared utility (low). The overall architecture is clean with good module boundaries and seam quality.
